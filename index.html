<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Gym Tracker - Mobile Optimized</title>
    <style>
        /* Mobile-First Performance Optimized CSS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #4f9f35;
            --primary-dark: #3a7d27;
            --white: #fff;
            --light-gray: #f8f9fa;
            --dark-gray: #333;
            --border-radius: 8px;
            --shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--light-gray);
            color: var(--dark-gray);
            line-height: 1.5;
            -webkit-text-size-adjust: 100%;
            touch-action: manipulation;
            overflow-x: hidden;
        }

        .container {
            max-width: 100%;
            margin: 0;
            padding: 16px;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--white);
            padding: 20px 16px;
            margin-bottom: 16px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: center;
        }

        .header h1 {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .theme-toggle {
            position: fixed;
            top: 16px;
            right: 16px;
            width: 48px;
            height: 48px;
            border: none;
            border-radius: 50%;
            background: var(--primary-color);
            color: var(--white);
            font-size: 1.2rem;
            cursor: pointer;
            box-shadow: var(--shadow);
            z-index: 1000;
            transition: transform 0.2s ease;
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        /* Controls */
        .controls {
            background: var(--white);
            padding: 16px;
            margin-bottom: 16px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-gray);
        }

        .form-group select,
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: var(--border-radius);
            font-size: 16px; /* Prevents zoom on iOS */
            background: var(--white);
            transition: border-color 0.2s ease;
        }

        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 12px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: var(--white);
        }

        .btn-primary:active {
            background: var(--primary-dark);
            transform: translateY(1px);
        }

        .btn-secondary {
            background: #6c757d;
            color: var(--white);
        }

        .btn-secondary:active {
            background: #545b62;
            transform: translateY(1px);
        }

        .btn-warning {
            background: #ffc107;
            color: #000;
        }

        .btn-warning:active {
            background: #e0a800;
            transform: translateY(1px);
        }

        .btn-danger {
            background: #dc3545;
            color: var(--white);
        }

        .btn-danger:active {
            background: #c82333;
            transform: translateY(1px);
        }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }

        /* Exercise Card */
        .exercise-card {
            background: var(--white);
            border-radius: var(--border-radius);
            margin-bottom: 16px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .exercise-header {
            padding: 16px;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: var(--white);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .exercise-header h3 {
            font-size: 1.1rem;
            margin: 0;
        }

        .collapse-icon {
            font-size: 1.2rem;
            transition: transform 0.2s ease;
        }

        .exercise-header.collapsed .collapse-icon {
            transform: rotate(-90deg);
        }

        .exercise-content {
            padding: 16px;
            display: block;
        }

        .exercise-content.hidden {
            display: none;
        }

        .set-container {
            display: grid;
            grid-template-columns: 1fr 60px 60px auto;
            gap: 8px;
            align-items: center;
            margin-bottom: 12px;
            padding: 12px;
            background: var(--light-gray);
            border-radius: var(--border-radius);
        }

        .set-label {
            font-weight: 600;
            color: var(--dark-gray);
        }

        .set-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
            font-size: 14px;
        }

        .weight-btn {
            padding: 6px;
            border: none;
            border-radius: 4px;
            background: #6c757d;
            color: var(--white);
            font-size: 12px;
            cursor: pointer;
            min-width: 32px;
        }

        .weight-btn:active {
            background: #545b62;
            transform: scale(0.95);
        }

        /* Timer */
        .timer {
            background: var(--white);
            padding: 16px;
            margin-bottom: 16px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: center;
        }

        .timer h3 {
            color: var(--primary-color);
            margin-bottom: 12px;
        }

        .timer-display {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--dark-gray);
            margin-bottom: 16px;
        }

        /* Dark Mode */
        body.dark-mode {
            background: #121212;
            color: #e0e0e0;
        }

        body.dark-mode .header,
        body.dark-mode .controls,
        body.dark-mode .exercise-card,
        body.dark-mode .timer {
            background: #1e1e1e;
            color: #e0e0e0;
        }

        body.dark-mode .form-group select,
        body.dark-mode .form-group input,
        body.dark-mode .set-input {
            background: #2c2c2c;
            color: #e0e0e0;
            border-color: #555;
        }

        body.dark-mode .set-container {
            background: #2c2c2c;
        }

        body.dark-mode .theme-toggle {
            background: #bb86fc;
        }

        /* Toast Messages */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #28a745;
            color: var(--white);
            padding: 12px 24px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .toast.show {
            opacity: 1;
        }

        .toast.error {
            background: #dc3545;
        }

        /* Loading State */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        /* Hide elements that cause performance issues */
        .quote-gallery,
        .sidebar,
        .complex-animations {
            display: none !important;
        }

        /* Performance optimizations */
        * {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        img {
            max-width: 100%;
            height: auto;
        }

        /* Reduce motion for performance */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Theme Toggle -->
        <button id="themeToggle" class="theme-toggle" onclick="toggleTheme()">üåô</button>

        <!-- Header -->
        <header class="header">
            <h1>üí™ Gym Tracker</h1>
            <p>Track your fitness progress efficiently</p>
        </header>

        <!-- Timer -->
        <div class="timer">
            <h3>‚è±Ô∏è Workout Timer</h3>
            <div class="timer-display" id="timerDisplay">00:00:00</div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="startTimer()">Start</button>
                <button class="btn btn-secondary" onclick="stopTimer()">Stop</button>
            </div>
        </div>

        <!-- Controls -->
        <div class="controls">
            <div class="form-group">
                <label for="daySelect">üìÖ Workout Day</label>
                <select id="daySelect">
                    <option value="chest">üèãÔ∏è Chest Day</option>
                    <option value="back">üîô Back Day</option>
                    <option value="legs">ü¶µ Leg Day</option>
                    <option value="shoulders">üí™ Shoulder Day</option>
                    <option value="arms">üí™ Arm Day</option>
                    <option value="cardio">üèÉ Cardio Day</option>
                </select>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-primary" onclick="addExercise()">‚ûï Add Exercise</button>
                <button class="btn btn-warning" onclick="loadLastWorkout()">üìÇ Load Last</button>
            </div>
            
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="saveWorkout()">üíæ Save Workout</button>
                <button class="btn btn-danger" onclick="resetWorkout()">üîÑ Reset</button>
            </div>
        </div>

        <!-- Exercises Container -->
        <div id="exercisesContainer"></div>

        <!-- Toast for messages -->
        <div id="toast" class="toast"></div>
    </div>

    <script>
        // Global Variables
        let workoutTimer = { startTime: null, elapsed: 0, interval: null };
        let currentWorkout = [];
        let isDarkMode = false;

        // Exercise Templates (simplified for performance)
        const exerciseTemplates = {
            chest: [
                'Bench Press', 'Push-ups', 'Incline Press', 'Dips', 
                'Flyes', 'Cable Crossover'
            ],
            back: [
                'Pull-ups', 'Deadlift', 'Barbell Rows', 'Lat Pulldown',
                'T-Bar Row', 'Cable Rows'
            ],
            legs: [
                'Squats', 'Leg Press', 'Lunges', 'Leg Curls',
                'Calf Raises', 'Leg Extensions'
            ],
            shoulders: [
                'Shoulder Press', 'Lateral Raises', 'Front Raises',
                'Rear Delts', 'Shrugs', 'Upright Rows'
            ],
            arms: [
                'Bicep Curls', 'Tricep Dips', 'Hammer Curls',
                'Tricep Extensions', 'Preacher Curls', 'Close Grip Press'
            ],
            cardio: [
                'Treadmill', 'Cycling', 'Rowing', 'Elliptical',
                'Jump Rope', 'Stairs'
            ]
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
            loadLastWorkout();
            updateTimerDisplay();
        });

        // Theme Management
        function toggleTheme() {
            isDarkMode = !isDarkMode;
            document.body.classList.toggle('dark-mode', isDarkMode);
            document.getElementById('themeToggle').textContent = isDarkMode ? '‚òÄÔ∏è' : 'üåô';
            localStorage.setItem('gymTrackerTheme', isDarkMode ? 'dark' : 'light');
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('gymTrackerTheme');
            if (savedTheme === 'dark') {
                isDarkMode = true;
                document.body.classList.add('dark-mode');
                document.getElementById('themeToggle').textContent = '‚òÄÔ∏è';
            }
        }

        // Timer Functions
        function startTimer() {
            if (!workoutTimer.interval) {
                workoutTimer.startTime = Date.now() - workoutTimer.elapsed;
                workoutTimer.interval = setInterval(updateTimerDisplay, 1000);
                showToast('Timer started! üí™', 'success');
            }
        }

        function stopTimer() {
            if (workoutTimer.interval) {
                clearInterval(workoutTimer.interval);
                workoutTimer.interval = null;
                showToast('Timer stopped! üõë', 'info');
            }
        }

        function updateTimerDisplay() {
            if (workoutTimer.interval) {
                workoutTimer.elapsed = Date.now() - workoutTimer.startTime;
            }
            
            const totalSeconds = Math.floor(workoutTimer.elapsed / 1000);
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            
            document.getElementById('timerDisplay').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Exercise Management
        function addExercise() {
            const selectedDay = document.getElementById('daySelect').value;
            const exercises = exerciseTemplates[selectedDay];
            
            // Simple exercise selection (optimized for mobile)
            const exerciseName = prompt('Choose exercise:\\n' + exercises.map((ex, i) => `${i+1}. ${ex}`).join('\\n'));
            
            if (exerciseName) {
                const exercise = {
                    id: Date.now(),
                    name: exerciseName,
                    sets: [
                        { weight: '', reps: '' },
                        { weight: '', reps: '' },
                        { weight: '', reps: '' }
                    ]
                };
                currentWorkout.push(exercise);
                renderExercises();
                showToast(`Added ${exerciseName}! üéØ`, 'success');
            }
        }

        function renderExercises() {
            const container = document.getElementById('exercisesContainer');
            container.innerHTML = '';

            currentWorkout.forEach((exercise, exerciseIndex) => {
                const exerciseCard = document.createElement('div');
                exerciseCard.className = 'exercise-card';
                
                exerciseCard.innerHTML = `
                    <div class="exercise-header" onclick="toggleExercise(${exerciseIndex})">
                        <h3>${exercise.name}</h3>
                        <span class="collapse-icon">‚ñº</span>
                    </div>
                    <div class="exercise-content" id="exercise-${exerciseIndex}">
                        ${exercise.sets.map((set, setIndex) => `
                            <div class="set-container">
                                <span class="set-label">Set ${setIndex + 1}</span>
                                <input type="number" class="set-input" placeholder="kg" 
                                       value="${set.weight}" 
                                       onchange="updateSet(${exerciseIndex}, ${setIndex}, 'weight', this.value)">
                                <input type="number" class="set-input" placeholder="reps" 
                                       value="${set.reps}"
                                       onchange="updateSet(${exerciseIndex}, ${setIndex}, 'reps', this.value)">
                                <div>
                                    <button class="weight-btn" onclick="adjustWeight(${exerciseIndex}, ${setIndex}, -5)">-5</button>
                                    <button class="weight-btn" onclick="adjustWeight(${exerciseIndex}, ${setIndex}, 5)">+5</button>
                                </div>
                            </div>
                        `).join('')}
                        <button class="btn btn-danger" onclick="removeExercise(${exerciseIndex})">üóëÔ∏è Remove</button>
                    </div>
                `;
                
                container.appendChild(exerciseCard);
            });
        }

        function toggleExercise(index) {
            const content = document.getElementById(`exercise-${index}`);
            const header = content.previousElementSibling;
            const isHidden = content.classList.contains('hidden');
            
            content.classList.toggle('hidden', !isHidden);
            header.classList.toggle('collapsed', !isHidden);
        }

        function updateSet(exerciseIndex, setIndex, field, value) {
            currentWorkout[exerciseIndex].sets[setIndex][field] = value;
            saveCurrentWorkout();
        }

        function adjustWeight(exerciseIndex, setIndex, amount) {
            const currentWeight = parseFloat(currentWorkout[exerciseIndex].sets[setIndex].weight) || 0;
            const newWeight = Math.max(0, currentWeight + amount);
            currentWorkout[exerciseIndex].sets[setIndex].weight = newWeight.toString();
            renderExercises();
            saveCurrentWorkout();
        }

        function removeExercise(index) {
            if (confirm('Remove this exercise?')) {
                currentWorkout.splice(index, 1);
                renderExercises();
                saveCurrentWorkout();
                showToast('Exercise removed! üóëÔ∏è', 'info');
            }
        }

        // Workout Management
        function saveWorkout() {
            if (currentWorkout.length === 0) {
                showToast('No exercises to save! ‚ö†Ô∏è', 'error');
                return;
            }

            const workout = {
                date: new Date().toISOString().split('T')[0],
                exercises: currentWorkout,
                duration: workoutTimer.elapsed
            };

            const savedWorkouts = JSON.parse(localStorage.getItem('gymTrackerWorkouts') || '[]');
            savedWorkouts.push(workout);
            localStorage.setItem('gymTrackerWorkouts', JSON.stringify(savedWorkouts));
            
            showToast('Workout saved! üíæ', 'success');
        }

        function loadLastWorkout() {
            const savedWorkouts = JSON.parse(localStorage.getItem('gymTrackerWorkouts') || '[]');
            if (savedWorkouts.length > 0) {
                const lastWorkout = savedWorkouts[savedWorkouts.length - 1];
                currentWorkout = lastWorkout.exercises || [];
                renderExercises();
                showToast('Last workout loaded! üìÇ', 'success');
            }
        }

        function resetWorkout() {
            if (confirm('Reset current workout?')) {
                currentWorkout = [];
                workoutTimer = { startTime: null, elapsed: 0, interval: null };
                renderExercises();
                updateTimerDisplay();
                showToast('Workout reset! üîÑ', 'info');
            }
        }

        function saveCurrentWorkout() {
            localStorage.setItem('gymTrackerCurrent', JSON.stringify(currentWorkout));
        }

        // Toast Messages
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Performance optimizations
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Prevent zoom on double tap (iOS)
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function (event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Add loading states for better UX
        function showLoading(element) {
            element.classList.add('loading');
        }

        function hideLoading(element) {
            element.classList.remove('loading');
        }
    </script>
</body>
</html>
